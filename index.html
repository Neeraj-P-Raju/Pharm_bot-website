<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PHARM-BOT Medicine Delivery</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
body{
background: linear-gradient(to right,#e8f5ff,#f6fffa);
font-family: Arial, sans-serif;
}

.header{
background:#0d6efd;
color:white;
padding:18px;
font-size:26px;
font-weight:bold;
display:flex;
justify-content:space-between;
align-items:center;
}

.side-img{
position:fixed;
top:120px;
width:140px;
opacity:0.9;
}
.left-img{ left:10px; }
.right-img{ right:10px; }

.card{
border-radius:15px;
box-shadow:0 4px 20px rgba(0,0,0,0.15);
}

.search-wrapper{
position:relative;
}

.search-icon{
position:absolute;
right:10px;
top:50%;
transform:translateY(-50%);
cursor:pointer;
font-size:18px;
}

#searchPanel{
display:none;
border:1px solid #ddd;
border-radius:10px;
max-height:250px;
overflow-y:auto;
background:white;
position:absolute;
width:100%;
z-index:10;
}

.popup{
display:none;
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
background:rgba(0,0,0,0.6);
justify-content:center;
align-items:center;
}

.popup-box{
background:white;
padding:30px;
border-radius:15px;
width:350px;
text-align:center;
}
.statusBox{
display:flex;
justify-content:space-between;
margin-top:15px;
}

.step{
flex:1;
margin:4px;
padding:8px;
border-radius:20px;
background:#ddd;
text-align:center;
font-size:13px;
font-weight:bold;
}

.activeStep{
background:#28a745;
color:white;
}
</style>
</head>

<body>

<div class="header">
<div>PHARM-BOT Medicine Delivery</div>
<button class="btn btn-light btn-sm" onclick="goLogin()">Staff Login</button>
</div>
<img src="https://cdn-icons-png.flaticon.com/512/2966/2966487.png" class="side-img left-img">
<img src="https://cdn-icons-png.flaticon.com/512/4320/4320337.png" class="side-img right-img">

<div class="container mt-5">
<div class="card p-4">

<h4 class="text-primary">Select Medicine</h4>

<div class="search-wrapper mt-3">
<input type="text" id="selectedMed" class="form-control" placeholder="Click search icon to choose medicine" readonly>
<span class="search-icon" onclick="toggleSearch()">üîç</span>

<div id="searchPanel"></div>
</div>

<hr>

<h4 class="text-success">Delivery Details</h4>

<input type="text" id="name" class="form-control mt-2" placeholder="Patient Name">
<input type="number" id="floor" class="form-control mt-2" placeholder="Floor Number">
<input type="text" id="room" class="form-control mt-2" placeholder="Room Number">

<select id="deliveryType" class="form-control mt-2">
<option>Room Delivery</option>
<option>Lift Pickup</option>
</select>

<button class="btn btn-primary mt-3 w-100" onclick="placeOrder()">Place Order</button>

</div>
</div>

<div id="popup" class="popup">
<div class="popup-box">

<h3 class="text-success">Order Placed Successfully!</h3>

<p id="orderDetails"></p>

<!-- ORDER STATUS TRACKER -->
<div class="statusBox">
<div class="step" id="s1">Placed</div>
<div class="step" id="s2">Approved</div>
<div class="step" id="s3">Dispatched</div>
<div class="step" id="s4">Delivered</div>
</div>

<br>
<button class="btn btn-primary" onclick="closePopup()">OK</button>

</div>
</div>
<!-- Firebase SDK -->

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyC0Ylf7UL_r-9CRC8t-HRuMHM_sUHZ2QDQ",
  authDomain: "pharmbot-delivery.firebaseapp.com",
  databaseURL: "https://pharmbot-delivery-default-rtdb.firebaseio.com",
  projectId: "pharmbot-delivery",
  storageBucket: "pharmbot-delivery.firebasestorage.app",
  messagingSenderId: "25166514207",
  appId: "1:25166514207:web:3212ee07a9256cbbafed2a"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();
</script>
<script>

function goLogin(){
window.location="login.html";
}

const medicines=[
"Paracetamol 500mg","Paracetamol 650mg","Dolo 650mg","Crocin 500mg",
"Aspirin 75mg","Ibuprofen 400mg","Amoxicillin 500mg",
"Azithromycin 500mg","Metformin 500mg","Pantoprazole 40mg",
"Cetirizine 10mg","Atorvastatin 10mg","Losartan 50mg",
"Amlodipine 5mg","Furosemide 40mg","Levothyroxine 50mcg",
"Diclofenac 50mg","Tramadol 50mg","Ondansetron 4mg",
"Vitamin D3 60000IU","Calcium 500mg","Iron 100mg",
"Glimepiride 2mg","Sitagliptin 100mg","Metoprolol 50mg",
"Enalapril 5mg","Ramipril 5mg","Telmisartan 40mg",
"Nifedipine 20mg","Digoxin 0.25mg","Levofloxacin 500mg",
"Doxycycline 100mg","Fluconazole 150mg","Acyclovir 400mg",
"Alprazolam 0.5mg","Diazepam 5mg","Sertraline 50mg",
"Risperidone 2mg","Gabapentin 300mg","Pregabalin 75mg",
"Carbamazepine 200mg","Allopurinol 300mg","Colchicine 0.6mg",
"Tamsulosin 0.4mg","Spironolactone 25mg","Bisoprolol 5mg",
"Cefuroxime 500mg","Linezolid 600mg","Tinidazole 500mg",
"Ivermectin 12mg","Oseltamivir 75mg","Clonazepam 0.5mg",
"Escitalopram 10mg","Olanzapine 5mg","Baclofen 10mg"
];

const panel = document.getElementById("searchPanel");

function toggleSearch() {
    panel.style.display = "block";

    panel.innerHTML = `
        <input id="searchInput" class="form-control mb-2" 
        placeholder="Search medicine..." 
        onkeyup="filterMed()">

        <div id="medList"></div>
    `;

    showResults(medicines);
}

function showResults(list) {
    const container = document.getElementById("medList");
    container.innerHTML = "";

    list.forEach(m => {
        container.innerHTML += `
            <div class="p-2 border bg-light" style="cursor:pointer"
            onclick="selectMed('${m}')">
                ${m}
            </div>
        `;
    });
}

function filterMed() {
    const input = document.getElementById("searchInput").value.toLowerCase();
    const filtered = medicines.filter(m => m.toLowerCase().includes(input));
    showResults(filtered);
}

function selectMed(med) {
    document.getElementById("selectedMed").value = med;
    panel.style.display = "none";
}

document.addEventListener("click", function(e) {
    if (!panel.contains(e.target) && !e.target.classList.contains("search-icon")) {
        panel.style.display = "none";
    }
});

function placeOrder(){

let name=document.getElementById("name").value.trim();
let floor=document.getElementById("floor").value.trim();
let room=document.getElementById("room").value.trim();
let med=document.getElementById("selectedMed").value.trim();
let delivery=document.getElementById("deliveryType").value;

if(!name||!floor||!room||!med){
alert("Please fill all details");
return;
}

let order={
    name:name,
    floor:floor,
    room:room,
    med:med,
    delivery:delivery,
    status:"Pending"
};

db.ref("orders").push(order);

document.getElementById("orderDetails").innerHTML=
`
Patient: ${name}<br>
Medicine: ${med}<br>
Floor: ${floor}<br>
Room: ${room}<br>
Delivery: ${delivery}
`;

document.getElementById("popup").style.display="flex";
document.getElementById("s1").classList.add("activeStep");

document.getElementById("name").value="";
document.getElementById("floor").value="";
document.getElementById("room").value="";
document.getElementById("selectedMed").value="";
}

function closePopup(){
document.getElementById("popup").style.display="none";
}

</script>
</body>
</html>