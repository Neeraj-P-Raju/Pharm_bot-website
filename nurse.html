<!DOCTYPE html>
<html>
<head>
<title>Nurse Dashboard</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<style>

body{
background: linear-gradient(to right,#dbeafe,#f0f9ff);
font-family: Arial;
}

/* Header */
.header{
background:#0d6efd;
color:white;
padding:20px;
text-align:center;
font-size:26px;
font-weight:bold;
letter-spacing:1px;
}

/* Card */
.dashboard-card{
background:white;
border-radius:15px;
padding:25px;
box-shadow:0 5px 25px rgba(0,0,0,0.1);
}

/* Table header */
.table thead{
background:#0d6efd;
color:white;
}

/* Status badges */
.badge-approved{
background:#198754;
}

.badge-delivered{
background:#6c757d;
}

/* Dispatch button */
.dispatch-btn{
background:#0d6efd;
color:white;
border:none;
padding:6px 14px;
border-radius:6px;
}

.dispatch-btn:hover{
background:#0b5ed7;
}

</style>
</head>

<body>

<div class="header">
Nurse Dashboard â€” PHARM BOT Delivery Panel
</div>

<div class="container mt-4">

<div class="dashboard-card">

<h4 class="text-primary mb-4">Approved Orders for Delivery</h4>

<table class="table table-bordered text-center">
<thead>
<tr>
<th>Patient</th>
<th>Medicine</th>
<th>Floor</th>
<th>Room</th>
<th>Delivery Type</th>
<th>Status</th>
</tr>
</thead>

<tbody id="orderTable"></tbody>

</table>

</div>
</div>

<script>

let orders = JSON.parse(localStorage.getItem("orders")) || [];
let table = document.getElementById("orderTable");

/* Filter only Approved orders */
let approvedOrders = orders.filter(order => order.status === "Approved");

if(approvedOrders.length === 0){
table.innerHTML = `<tr><td colspan="6">No Approved Orders</td></tr>`;
}
else{

approvedOrders.forEach((order,index)=>{

let realIndex = orders.findIndex(o =>
o.name===order.name &&
o.med===order.med &&
o.room===order.room
);

table.innerHTML += `
<tr>
<td>${order.name}</td>
<td>${order.med}</td>
<td>${order.floor}</td>
<td>${order.room}</td>
<td>${order.delivery}</td>

<td>
${order.status === "Approved"
? `<button class="dispatch-btn" onclick="dispatch(${realIndex})">Dispatch</button>`
: `<span class="badge badge-delivered">Delivered</span>`
}
</td>

</tr>
`;

});

}

/* Dispatch Function */
function dispatch(index){

orders[index].status = "Delivered";

localStorage.setItem("orders",JSON.stringify(orders));

alert("Order Delivered Successfully!");

location.reload();

}

</script>

</body>
</html>